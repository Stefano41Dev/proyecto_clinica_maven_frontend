<app-navbar-paciente></app-navbar-paciente>

<div class="container-fluid p-0 min-vh-100 d-flex justify-content-center">

  <div class="card border-0 w-80 d-flex flex-column" style="width: 80%;">

    <div class="card-header bg-primary text-white border-0">
      <h5 class="mb-0">Información de la Cita</h5>
    </div>

    <div class="card-body flex-grow-1 d-flex flex-column" style="background-color: #f4f7fb;">

      <div class="form-grid flex-grow-1">
        <br>
        <div class="col-12">
                <h6 class="text-muted border-bottom pb-2">
                  Información Cita
                </h6>
              </div>
        <div>
        <!-- DATOS CITA -->
        <div>
          <label class="form-label fw-bold">ID Cita</label>
          <input class="form-control" [value]="cita.idCita" disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Fecha Programada</label>
          <input class="form-control" [value]="cita.fechaProgramada" disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Hora</label>
          <input class="form-control" [value]="cita.hora" disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Estado de la Cita</label>
          <input class="form-control"
                 [value]="cita.estadoCitaResponse.nombreEstado"
                 disabled>
        </div>

        <div class="col-12">
          <label class="form-label fw-bold">Motivo</label>
          <textarea class="form-control"
                    rows="2"
                    [value]="cita.motivo"
                    disabled>
          </textarea>
        </div>
        <br>
        <div class="col-12">
                <h6 class="text-muted border-bottom pb-2">
                  Información Personal Paciente
                </h6>
              </div>
        <div>
        <!-- DATOS PACIENTE -->
        <div>
          <label class="form-label fw-bold">Paciente</label>
          <input class="form-control"
                 [value]="cita.pacienteResponse.nombres + ' ' + cita.pacienteResponse.apellidos"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Documento</label>
          <input class="form-control"
                 [value]="cita.pacienteResponse.tipoDocumentoResponse.nombreDocumento + ' - ' + cita.pacienteResponse.numeroDocumento"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Sexo</label>
          <input class="form-control"
                 [value]="cita.pacienteResponse.tipoSexoResponse.sexo"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Estado Civil</label>
          <input class="form-control"
                 [value]="cita.pacienteResponse.estadoCivilResponse.nombreEstado"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Correo Paciente</label>
          <input class="form-control"
                 [value]="cita.pacienteResponse.correo"
                 disabled>
        </div>
        <br>
        <div class="col-12">
                <h6 class="text-muted border-bottom pb-2">
                  Información Personal Medico
                </h6>
              </div>
        <div>
        <!-- DATOS MÉDICO -->
        <div>
          <label class="form-label fw-bold">Médico</label>
          <input class="form-control"
                 [value]="cita.medicoResponse.nombres + ' ' + cita.medicoResponse.apellidos"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Especialidad</label>
          <input class="form-control"
                 [value]="cita.medicoResponse.especialidadResponse.nombre"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">N° Colegiatura</label>
          <input class="form-control"
                 [value]="cita.medicoResponse.numeroColegiatura"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Teléfono Médico</label>
          <input class="form-control"
                 [value]="cita.medicoResponse.telefono"
                 disabled>
        </div>

        <div>
          <label class="form-label fw-bold">Correo Médico</label>
          <input class="form-control"
                 [value]="cita.medicoResponse.correo"
                 disabled>
        </div>

      </div>
      
      <div class="mt-3 text-end">
        <button class="btn btn-outline-primary" (click)="retroceder()">
          ← Retroceder
        </button>
        <button 
            *ngIf="esAtendida"
            class="btn btn-primary ms-2"
            (click)="abrirModalHistorialMedico()">
            Generar Historial Médico
        </button>
      </div>

    </div>

  </div>
  <!-- MODAL HISTORIAL MEDICO -->
    <div class="modal fade" id="modalHistorialMedico" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">

        <div class="modal-header bg-primary text-white">
            <h5 class="modal-title">Generar Historial Médico</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>

        <form [formGroup]="historialForm" (ngSubmit)="guardarHistorial()">

            <div class="modal-body">

            <div class="mb-3">
                <label class="form-label fw-bold">Diagnóstico</label>
                <textarea 
                class="form-control"
                rows="3"
                formControlName="diagnostico">
                </textarea>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold">Tratamiento</label>
                <textarea 
                class="form-control"
                rows="3"
                formControlName="tratamiento">
                </textarea>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold">Observaciones</label>
                <textarea 
                class="form-control"
                rows="2"
                formControlName="observaciones">
                </textarea>
            </div>

            </div>

            <div class="modal-footer">
            <button type="button" 
                    class="btn btn-secondary"
                    data-bs-dismiss="modal">
                Cancelar
            </button>

            <button type="submit" 
                    class="btn btn-success"
                    [disabled]="historialForm.invalid">
                Guardar Historial
            </button>
            </div>

        </form>

        </div>
    </div>
    </div>
</div>